<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="This module contains the LLVM intrinsics bindings that provide the functionality for this crate."><title>core::core_simd::intrinsics - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-2fcac8296ac587d8.css" id="mainThemeStyle"><div id="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="core" data-themes="" data-resource-suffix="" data-rustdoc-version="1.72.0-nightly (b2b34bd83 2023-06-06)" data-search-js="search-4926e5fc22a5646a.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ></div><script src="../../../static.files/storage-62ce34ea385b278a.js"></script><script defer src="../../../static.files/main-48600a9606eff342.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../../../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../../../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"><script src="/nav.js"></script>
</head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../../core/index.html"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../../core/index.html"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Module intrinsics</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#functions">Functions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../../index.html">core</a>::<wbr><a href="../index.html">core_simd</a>::<wbr><a class="mod" href="#">intrinsics</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../../src/core/portable-simd/crates/core_simd/src/intrinsics.rs.html#1-163">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><span class="item-info"><div class="stab unstable"><span class="emoji">🔬</span><span>This is a nightly-only experimental API. (<code>portable_simd</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/86656">#86656</a>)</span></div></span><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>This module contains the LLVM intrinsics bindings that provide the functionality for this
crate.</p>
<p>The LLVM assembly language is documented here: <a href="https://llvm.org/docs/LangRef.html">https://llvm.org/docs/LangRef.html</a></p>
<p>A quick glossary of jargon that may appear in this module, mostly paraphrasing LLVM’s LangRef:</p>
<ul>
<li>poison: “undefined behavior as a value”. specifically, it is like uninit memory (such as padding bytes). it is “safe” to create poison, BUT
poison MUST NOT be observed from safe code, as operations on poison return poison, like NaN. unlike NaN, which has defined comparisons,
poison is neither true nor false, and LLVM may also convert it to undef (at which point it is both). so, it can’t be conditioned on, either.</li>
<li>undef: “a value that is every value”. functionally like poison, insofar as Rust is concerned. poison may become this. note:
this means that division by poison or undef is like division by zero, which means it inflicts…</li>
<li>“UB”: poison and undef cover most of what people call “UB”. “UB” means this operation immediately invalidates the program:
LLVM is allowed to lower it to <code>ud2</code> or other opcodes that may cause an illegal instruction exception, and this is the “good end”.
The “bad end” is that LLVM may reverse time to the moment control flow diverged on a path towards undefined behavior,
and destroy the other branch, potentially deleting safe code and violating Rust’s <code>unsafe</code> contract.</li>
</ul>
<p>Note that according to LLVM, vectors are not arrays, but they are equivalent when stored to and loaded from memory.</p>
<p>Unless stated otherwise, all intrinsics for binary operations require SIMD vectors of equal types and lengths.</p>
</div></details><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.simd_add.html" title="fn core::core_simd::intrinsics::simd_add">simd_add</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div><div class="desc docblock-short">add/fadd</div></li><li><div class="item-name"><a class="fn" href="fn.simd_and.html" title="fn core::core_simd::intrinsics::simd_and">simd_and</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div><div class="desc docblock-short">and</div></li><li><div class="item-name"><a class="fn" href="fn.simd_arith_offset.html" title="fn core::core_simd::intrinsics::simd_arith_offset">simd_arith_offset</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div><div class="desc docblock-short">getelementptr (without inbounds)
equivalent to wrapping_offset</div></li><li><div class="item-name"><a class="fn" href="fn.simd_as.html" title="fn core::core_simd::intrinsics::simd_as">simd_as</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div><div class="desc docblock-short">follows Rust’s <code>T as U</code> semantics, including saturating float casts
which amounts to the same as <code>simd_cast</code> for many cases</div></li><li><div class="item-name"><a class="fn" href="fn.simd_bitmask.html" title="fn core::core_simd::intrinsics::simd_bitmask">simd_bitmask</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div></li><li><div class="item-name"><a class="fn" href="fn.simd_cast.html" title="fn core::core_simd::intrinsics::simd_cast">simd_cast</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div><div class="desc docblock-short">fptoui/fptosi/uitofp/sitofp
casting floats to integers is truncating, so it is safe to convert values like e.g. 1.5
but the truncated value must fit in the target type or the result is poison.
use <code>simd_as</code> instead for a cast that performs a saturating conversion.</div></li><li><div class="item-name"><a class="fn" href="fn.simd_cast_ptr.html" title="fn core::core_simd::intrinsics::simd_cast_ptr">simd_cast_ptr</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div><div class="desc docblock-short">equivalent to <code>T as U</code> semantics, specifically for pointers</div></li><li><div class="item-name"><a class="fn" href="fn.simd_div.html" title="fn core::core_simd::intrinsics::simd_div">simd_div</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div><div class="desc docblock-short">udiv/sdiv/fdiv
ints and uints: {s,u}div incur UB if division by zero occurs.
ints: sdiv is UB for int::MIN / -1.
floats: fdiv is never UB, but may create NaNs or infinities.</div></li><li><div class="item-name"><a class="fn" href="fn.simd_eq.html" title="fn core::core_simd::intrinsics::simd_eq">simd_eq</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div></li><li><div class="item-name"><a class="fn" href="fn.simd_expose_addr.html" title="fn core::core_simd::intrinsics::simd_expose_addr">simd_expose_addr</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div><div class="desc docblock-short">expose a pointer as an address</div></li><li><div class="item-name"><a class="fn" href="fn.simd_fabs.html" title="fn core::core_simd::intrinsics::simd_fabs">simd_fabs</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div><div class="desc docblock-short">fabs</div></li><li><div class="item-name"><a class="fn" href="fn.simd_fmax.html" title="fn core::core_simd::intrinsics::simd_fmax">simd_fmax</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div></li><li><div class="item-name"><a class="fn" href="fn.simd_fmin.html" title="fn core::core_simd::intrinsics::simd_fmin">simd_fmin</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div></li><li><div class="item-name"><a class="fn" href="fn.simd_from_exposed_addr.html" title="fn core::core_simd::intrinsics::simd_from_exposed_addr">simd_from_exposed_addr</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div><div class="desc docblock-short">convert an exposed address back to a pointer</div></li><li><div class="item-name"><a class="fn" href="fn.simd_gather.html" title="fn core::core_simd::intrinsics::simd_gather">simd_gather</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div><div class="desc docblock-short">llvm.masked.gather
like a loop of pointer reads
val: vector of values to select if a lane is masked
ptr: vector of pointers to read from
mask: a “wide” mask of integers, selects as if simd_select(mask, read(ptr), val)
note, the LLVM intrinsic accepts a mask vector of <code>&lt;N x i1&gt;</code>
FIXME: review this if/when we fix up our mask story in general?</div></li><li><div class="item-name"><a class="fn" href="fn.simd_ge.html" title="fn core::core_simd::intrinsics::simd_ge">simd_ge</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div></li><li><div class="item-name"><a class="fn" href="fn.simd_gt.html" title="fn core::core_simd::intrinsics::simd_gt">simd_gt</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div></li><li><div class="item-name"><a class="fn" href="fn.simd_le.html" title="fn core::core_simd::intrinsics::simd_le">simd_le</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div></li><li><div class="item-name"><a class="fn" href="fn.simd_lt.html" title="fn core::core_simd::intrinsics::simd_lt">simd_lt</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div></li><li><div class="item-name"><a class="fn" href="fn.simd_mul.html" title="fn core::core_simd::intrinsics::simd_mul">simd_mul</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div><div class="desc docblock-short">mul/fmul</div></li><li><div class="item-name"><a class="fn" href="fn.simd_ne.html" title="fn core::core_simd::intrinsics::simd_ne">simd_ne</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div></li><li><div class="item-name"><a class="fn" href="fn.simd_neg.html" title="fn core::core_simd::intrinsics::simd_neg">simd_neg</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div><div class="desc docblock-short">neg/fneg
ints: ultimately becomes a call to cg_ssa’s BuilderMethods::neg. cg_llvm equates this to <code>simd_sub(Simd::splat(0), x)</code>.
floats: LLVM’s fneg, which changes the floating point sign bit. Some arches have instructions for it.
Rust panics for Neg::neg(int::MIN) due to overflow, but it is not UB in LLVM without <code>nsw</code>.</div></li><li><div class="item-name"><a class="fn" href="fn.simd_or.html" title="fn core::core_simd::intrinsics::simd_or">simd_or</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div><div class="desc docblock-short">or</div></li><li><div class="item-name"><a class="fn" href="fn.simd_reduce_add_ordered.html" title="fn core::core_simd::intrinsics::simd_reduce_add_ordered">simd_reduce_add_ordered</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div></li><li><div class="item-name"><a class="fn" href="fn.simd_reduce_all.html" title="fn core::core_simd::intrinsics::simd_reduce_all">simd_reduce_all</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div></li><li><div class="item-name"><a class="fn" href="fn.simd_reduce_and.html" title="fn core::core_simd::intrinsics::simd_reduce_and">simd_reduce_and</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div></li><li><div class="item-name"><a class="fn" href="fn.simd_reduce_any.html" title="fn core::core_simd::intrinsics::simd_reduce_any">simd_reduce_any</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div></li><li><div class="item-name"><a class="fn" href="fn.simd_reduce_max.html" title="fn core::core_simd::intrinsics::simd_reduce_max">simd_reduce_max</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div></li><li><div class="item-name"><a class="fn" href="fn.simd_reduce_min.html" title="fn core::core_simd::intrinsics::simd_reduce_min">simd_reduce_min</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div></li><li><div class="item-name"><a class="fn" href="fn.simd_reduce_mul_ordered.html" title="fn core::core_simd::intrinsics::simd_reduce_mul_ordered">simd_reduce_mul_ordered</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div></li><li><div class="item-name"><a class="fn" href="fn.simd_reduce_or.html" title="fn core::core_simd::intrinsics::simd_reduce_or">simd_reduce_or</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div></li><li><div class="item-name"><a class="fn" href="fn.simd_reduce_xor.html" title="fn core::core_simd::intrinsics::simd_reduce_xor">simd_reduce_xor</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div></li><li><div class="item-name"><a class="fn" href="fn.simd_rem.html" title="fn core::core_simd::intrinsics::simd_rem">simd_rem</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div><div class="desc docblock-short">urem/srem/frem
ints and uints: {s,u}rem incur UB if division by zero occurs.
ints: srem is UB for int::MIN / -1.
floats: frem is equivalent to libm::fmod in the “default” floating point environment, sans errno.</div></li><li><div class="item-name"><a class="fn" href="fn.simd_saturating_add.html" title="fn core::core_simd::intrinsics::simd_saturating_add">simd_saturating_add</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div></li><li><div class="item-name"><a class="fn" href="fn.simd_saturating_sub.html" title="fn core::core_simd::intrinsics::simd_saturating_sub">simd_saturating_sub</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div></li><li><div class="item-name"><a class="fn" href="fn.simd_scatter.html" title="fn core::core_simd::intrinsics::simd_scatter">simd_scatter</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div><div class="desc docblock-short">llvm.masked.scatter
like gather, but more spicy, as it writes instead of reads</div></li><li><div class="item-name"><a class="fn" href="fn.simd_select.html" title="fn core::core_simd::intrinsics::simd_select">simd_select</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div></li><li><div class="item-name"><a class="fn" href="fn.simd_select_bitmask.html" title="fn core::core_simd::intrinsics::simd_select_bitmask">simd_select_bitmask</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div></li><li><div class="item-name"><a class="fn" href="fn.simd_shl.html" title="fn core::core_simd::intrinsics::simd_shl">simd_shl</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div><div class="desc docblock-short">shl
for (u)ints. poison if rhs &gt;= lhs::BITS</div></li><li><div class="item-name"><a class="fn" href="fn.simd_shr.html" title="fn core::core_simd::intrinsics::simd_shr">simd_shr</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div><div class="desc docblock-short">ints: ashr
uints: lshr
poison if rhs &gt;= lhs::BITS</div></li><li><div class="item-name"><a class="fn" href="fn.simd_shuffle.html" title="fn core::core_simd::intrinsics::simd_shuffle">simd_shuffle</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div></li><li><div class="item-name"><a class="fn" href="fn.simd_sub.html" title="fn core::core_simd::intrinsics::simd_sub">simd_sub</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div><div class="desc docblock-short">sub/fsub</div></li><li><div class="item-name"><a class="fn" href="fn.simd_xor.html" title="fn core::core_simd::intrinsics::simd_xor">simd_xor</a><span title="Restricted Visibility">&nbsp;🔒</span> <sup title="unsafe function">⚠</sup><span class="stab unstable" title="">Experimental</span></div><div class="desc docblock-short">xor</div></li></ul></section></div></main></body></html>